<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <div id="qrcde"></div>
</head>
<body>
        <div id="record" style="align-content: center;background-color: #2B81AF;height: 50px;width:100px" value="开始录音"></div>
        <div id="cancelRecord" style="align-content: center;background-color: #9A0000;height: 50px;width:100px" value="停止录音"></div>
        <div id="playRecord" style="align-content: center;background-color: #0bb20c;height: 50px;width:100px" value="播放录音"></div>
</body>
</html>
<script src="jquery-3.2.1.min.js"></script>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
    $(function(){
        signature = '';
        $.ajax({
            url:'http://39.108.237.198/project/index.php?m=Api&c=JsSdk&a=getSignPackage&debugging=test',
            type:'POST',
            data : {'url':location.href},
            success:function(data){
                console.log(data);
                signature = data.data;
            }
        });

        function startRecord(signature){
            wx.config({
                debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: signature.appId, // 必填，公众号的唯一标识
                timestamp: signature.timestamp, // 必填，生成签名的时间戳
                nonceStr:  signature.nonceStr, // 必填，生成签名的随机串
                signature:  signature.signature,// 必填，签名，见附录1
                jsApiList: [
                    'startRecord','stopRecord','playVoice'
                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
            wx.ready(function () {
                wx.startRecord();
            })
        }
        function stopRecord(signature) {
            wx.config({
                debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: signature.appId, // 必填，公众号的唯一标识
                timestamp: signature.timestamp, // 必填，生成签名的时间戳
                nonceStr:  signature.nonceStr, // 必填，生成签名的随机串
                signature:  signature.signature,// 必填，签名，见附录1
                jsApiList: [
                    'startRecord','stopRecord'
                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
            wx.ready(function () {
                wx.stopRecord({
                    success: function (res) {
                        var localId = res.localId;
                        console.log(localId);
                        return localId;
                    }
                });
            })
        }
        function playRecord(signature) {
            var localId =localId;
            wx.config({
                debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: signature.appId, // 必填，公众号的唯一标识
                timestamp: signature.timestamp, // 必填，生成签名的时间戳
                nonceStr:  signature.nonceStr, // 必填，生成签名的随机串
                signature:  signature.signature,// 必填，签名，见附录1
                jsApiList: [
                    'startRecord','stopRecord'
                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
            wx.ready(function () {
                wx.playVoice({
                    localId:531310647334223,  // 需要播放的音频的本地ID，由stopRecord接口获得
                });
            })
        }
        localId = '';
       $('#record').click(function(){
            startRecord(signature);
       })
        $('#cancelRecord').click(function(){
            localId = stopRecord(signature);
        })
        $('#playRecord').click(function(){
            playRecord(signature);
        })
    });
</script>